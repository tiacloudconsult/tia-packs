      jobs:
      - job: SonarScan
        displayName: 'Sonar Scan'
        pool: 
          name: $(windows_build_agent_pool)
        variables:
          projectKey: {{ '${{ variables.projectKey }}' }}
        steps:
          - task: JavaToolInstaller@0
            inputs:
              versionSpec: '8'
              jdkArchitectureOption: 'x64'
              jdkSourceOption: 'PreInstalled'

          - task: SonarQubePrepare@5
            inputs:
              SonarQube: $(sonarqube_service_connection)
              scannerMode: 'MSBuild'
              projectKey: {{ project_identifier }}             

          - task: DotNetCoreCLI@2
            inputs:
              command: 'restore'
              feedsToUse: 'select' 
              
          - task: DotNetCoreCLI@2
            inputs:
              command: 'build'
   
          - task: SonarQubeAnalyze@5
          
          - task: SonarQubePublish@5
            inputs:
              pollingTimeoutSec: '300'
